<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<title>MAD|内网IP信息</title>

	<!-- Favicon -->
	<link rel="shortcut icon" href="../img/favicon.png">
	<link rel="icon" href="../img/favicon.png" type="image/x-icon">

	<!-- vector map CSS -->
	<link href="../vendors/vectormap/jquery-jvectormap-2.0.2.css" rel="stylesheet" type="text/css"/>

	<!-- Footable CSS -->
	<link href="../vendors/bower_components/FooTable/compiled/footable.bootstrap.min.css" rel="stylesheet" type="text/css"/>

	<!-- Custom CSS -->
	<link href="dist/css/style.css" rel="stylesheet" type="text/css">

    <!-- jQuery -->
    <script src="../vendors/bower_components/jquery/dist/jquery.min.js"></script>
	<script type="text/javascript">
		$.getJSON ("/report/innerIP/index.json", function (data) {
		    $.each(data, function (i, item) {
				$.getJSON(item, function (data) {
					$.each(data, function (i, item) {
					    var UA = item.UA;
					    var UATable = "";
					    for(var i=0;i<UA.length;i++){
							UATable = UATable + "<tr><td>" + UA[i].name +
								"</td><td>" + UA[i].stime +
								"</td><td>" + UA[i].etime + "</td>";
							if(UA[i].type==="1"){
							    UATable = UATable + "<td><span class=\"label label-danger\">恶意</span></td>";
							}else{
							    UATable = UATable + "<td><span class=\"label label-success\">良性</span></td>";
							}
							var info = UA[i].info;
							UATable = UATable + "<td>" + info.comment +
								"</td><td>" + info.desc +
								"</td><td>" + info.link +
								"</td><td>" + info.type + "</td></tr>"
						}
						UATable = "<p data-toggle=\"modal\" data-target=\"." + item.IP.replace(/\./g,"_") + "\">详细信息</p>" +
							"<div class=\"modal fade " + item.IP.replace(/\./g,"_") + "\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myLargeModalLabel\" aria-hidden=\"true\" style=\"display: none;\">" +
							"<div class=\"modal-dialog modal-lg\">" +
							"<div class=\"modal-content\">" +
							"<div class=\"modal-header\">" +
							"<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">×</button>" +
							"<h5 class=\"modal-title\" id=\"myLargeModalLabel\">详细信息</h5>" +
							"</div><div class=\"modal-body\"><div class=\"table-wrap\">" +
							"<table id=\"footable_" + item.IP.replace(/\./g,"_") + "\" class=\"table\" data-filtering=\"true\"  data-show-toggle=\"false\">" +
							"<thead><tr><th data-breakpoints=\"xs\">名称</th><th>第一次运行时间</th><th data-breakpoints=\"xs\">最后一次运行时间</th><th data-breakpoints=\"xs sm\">种类</th>" +
							"<th data-breakpoints=\"all\" data-title=\"comment\">备注</th>" +
							"<th data-breakpoints=\"all\" data-title=\"description\">描述</th>" +
							"<th data-breakpoints=\"all\" data-title=\"link\">链接</th>" +
							"<th data-breakpoints=\"all\" data-title=\"type\">类型</th></tr></thead><tbody>" +
							UATable + "</tbody></table></div></div><div class=\"modal-footer\">" +
							"<button type=\"button\" class=\"btn btn-danger text-left\" data-dismiss=\"modal\">Close</button>" +
							"</div></div></div></div>";
						UATable = "<tr><td>" + item.IP +
							"</td><td>" + item.total +
							"</td><td>" + item.malicious +
							"</td><td>" + UATable + "</td></tr>";
						$("#results-display").append(UATable);
					});
				});
			});
        });
	</script>
</head>

<body>
	<!-- Preloader -->
	<div class="preloader-it">
		<div class="la-anim-1"></div>
	</div>
	<!-- /Preloader -->
    <div class="wrapper theme-6-active pimary-color-pink">
		<!-- Top Menu Items -->
		<nav class="navbar navbar-inverse navbar-fixed-top">
			<div class="mobile-only-brand pull-left">
				<div class="nav-header pull-left">
					<div class="logo-wrap">
						<a target="_blank" href="index.html">
							<img class="brand-img" src="../img/logo.png" alt="brand"/>
							<span class="brand-text">MAD</span>
						</a>
					</div>
				</div>
				<a id="toggle_nav_btn" class="toggle-left-nav-btn inline-block ml-20 pull-left" href="javascript:void(0);"><i class="zmdi zmdi-menu"></i></a>
				<a id="toggle_mobile_nav" class="mobile-only-view" href="javascript:void(0);"><i class="zmdi zmdi-more"></i></a>
			</div>
		</nav>
		<!-- /Top Menu Items -->

		<!-- Left Sidebar Menu -->
		<div class="fixed-sidebar-left">
			<ul class="nav navbar-nav side-nav nicescroll-bar">
				<li class="navigation-header">
					<span>主页</span>
					<i class="zmdi zmdi-more"></i>
				</li>
				<li>
					<a target="_blank" href="index.html"><div class="pull-left"><i class="zmdi zmdi-star-circle mr-20"></i><span class="right-nav-text">主页</span></div><div class="pull-right"></div><div class="clearfix"></div></a>
				</li>
				<li>
					<a target="_blank" href="abstract.html"><div class="pull-left"><i class="zmdi zmdi-chart mr-20"></i><span class="right-nav-text">概要统计</span></div><div class="pull-right"></div><div class="clearfix"></div></a>
				</li>
				<li><hr class="light-grey-hr mb-10"/></li>
				<li class="navigation-header">
					<span>统计</span>
					<i class="zmdi zmdi-more"></i>
				</li>
				<li>
					<a target="_blank" class="active" href="inner_detail.html"><div class="pull-left"><i class="zmdi zmdi-view-list-alt mr-20"></i><span class="right-nav-text">内网IP信息</span></div><div class="pull-right"></div><div class="clearfix"></div></a>
				</li>
				<li>
					<a target="_blank" href="ua_detail.html"><div class="pull-left"><i class="zmdi zmdi-view-list-alt mr-20"></i><span class="right-nav-text">UA详细信息</span></div><div class="pull-right"></div><div class="clearfix"></div></a>
				</li>
				<li>
					<a target="_blank" href="outer_detail.html"><div class="pull-left"><i class="zmdi zmdi-view-list-alt mr-20"></i><span class="right-nav-text">通信服务器信息</span></div><div class="pull-right"></div><div class="clearfix"></div></a>
				</li>
				<li><hr class="light-grey-hr mb-10"/></li>
				<li class="navigation-header">
					<span>关于</span>
					<i class="zmdi zmdi-more"></i>
				</li>
				<li>
					<a target="_blank" href="usage.html"><div class="pull-left"><i class="zmdi zmdi-pin-help mr-20"></i><span class="right-nav-text">使用方法</span></div><div class="pull-right"></div><div class="clearfix"></div></a>
				</li>
				<li>
					<a target="_blank" href="intro.html"><div class="pull-left"><i class="zmdi zmdi-puzzle-piece mr-20"></i><span class="right-nav-text">系统介绍</span></div><div class="pull-right"></div><div class="clearfix"></div></a>
				</li>
				<li>
					<a target="_blank" href="about.html"><div class="pull-left"><i class="zmdi zmdi-accounts mr-20"></i><span class="right-nav-text">关于我们</span></div><div class="pull-right"></div><div class="clearfix"></div></a>
				</li>
				<li>
					<a target="_blank" href="download.html"><div class="pull-left"><i class="zmdi zmdi-download mr-20"></i><span class="right-nav-text">下载专区</span></div><div class="pull-right"></div><div class="clearfix"></div></a>
				</li>
				<li><hr class="light-grey-hr mb-10"/></li>
			</ul>
		</div>
		<!-- /Left Sidebar Menu -->

        <!-- Main Content -->
		<div class="page-wrapper">
            <div class="container-fluid pt-25">

				<!-- Title -->
				<div class="row heading-bg">
					<div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">
					  <h5 class="txt-dark">内网IP信息</h5>
					</div>
					<!-- Breadcrumb -->
					<div class="col-lg-9 col-sm-8 col-md-8 col-xs-12">
					  <ol class="breadcrumb">
						<li><a href="index.html">主页</a></li>
						<li><a href="#"><span>统计</span></a></li>
						<li class="active"><span>内网IP信息</span></li>
					  </ol>
					</div>
					<!-- /Breadcrumb -->
				</div>
				<!-- /Title -->

				<!-- Row -->
				<div class="row">
					<div class="col-sm-12">
						<div class="panel panel-default card-view">
							<div class="panel-wrapper collapse in">
								<div class="panel-body">
									<div class="table-wrap">
										<table id="footable_3" class="table" data-filtering="true"  data-show-toggle="false">
											<thead>
												<tr>
													<th>IP地址</th>
													<th>UA总数</th>
													<th>恶意UA数量</th>
													<th>查看所有UA</th>
												</tr>
											</thead>
											<tbody id="results-display">
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- /Row -->

			</div>

			<!-- Footer -->
			<footer class="footer container-fluid pl-30 pr-30">
				<div class="row">
					<div class="col-sm-12">
						<p>2018 &copy; C&D</p>
					</div>
				</div>
			</footer>
			<!-- /Footer -->

		</div>
        <!-- /Main Content -->

    </div>
    <!-- /#wrapper -->


	<!-- JavaScript -->

		<!-- Bootstrap Core JavaScript -->
		<script src="../vendors/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

		<!-- Data table JavaScript -->
		<script src="../vendors/bower_components/moment/min/moment.min.js"></script>
		<script src="../vendors/bower_components/FooTable/compiled/footable.min.js" type="text/javascript"></script>
		<script src="dist/js/footable-data.js"></script>

		<!-- Slimscroll JavaScript -->
		<script src="dist/js/jquery.slimscroll.js"></script>

		<!-- Fancy Dropdown JS -->
		<script src="dist/js/dropdown-bootstrap-extended.js"></script>

		<!-- Owl JavaScript -->
		<script src="../vendors/bower_components/owl.carousel/dist/owl.carousel.min.js"></script>

		<!-- Switchery JavaScript -->
		<script src="../vendors/bower_components/switchery/dist/switchery.min.js"></script>

		<!-- Init JavaScript -->
		<script src="dist/js/init.js"></script>
</body>

</html>
